function scriptText = my_genscript(varargin)
    %GENSCRIPT Generate a MATLAB script for running tests.
    TestFiles= varargin{35};
    testFilesStr = strjoin(cellfun(@(x) ['''', x, ''''], TestFiles, 'UniformOutput', false), ', ');
    scriptText = join([ ...
        "import matlab.unittest.TestRunner;", ...
        "import matlab.unittest.plugins.XMLPlugin;", ...
        "import matlab.unittest.TestSuite;", ...
        newline, ...
        "suite = testsuite('tests', 'IncludingSubfolders', true);", ...
        "TestFiles = {" + testFilesStr + "};", ...
        "suites = {};", ...
        "for i = 1:length(TestFiles)", ...
        "    suites{end+1} = TestSuite.fromFile(TestFiles{i});",...
        "end", ...
        "suite = [suites{:}];", ...
        newline, ...
        "runner = TestRunner.withTextOutput();", ...
        "runner.addPlugin(XMLPlugin.producingJUnitFormat('results.xml'));", ...
        newline, ...
        "results = runner.run(suite);", ...
        "display(results);", ...
        newline, ...
        "assertSuccess(results);" ...
    ], newline);

    % Convert to character array 
    scriptText = char(scriptText);
    disp('Running MATLAB script with contents:');
    disp('__________');
    disp(scriptText);
    disp('__________');

    eval(scriptText);  
end